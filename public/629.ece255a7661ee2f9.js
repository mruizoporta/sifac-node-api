"use strict";(self.webpackChunksifac_oporta=self.webpackChunksifac_oporta||[]).push([[629],{6629:(at,f,r)=>{r.r(f),r.d(f,{MarcasModule:()=>k});var g=r(6895),v=r(3060),b=r(7974),h=r(6308),s=r(7155),T=r(382),c=r(4006),d=r(5938),t=r(4650),A=r(2340),U=r(529);let C=(()=>{class e{constructor(a){this.http=a,this.baseUrl=A.N.baseUrl}getbrands(a){return this.http.get(`${this.baseUrl}/brand/${a}`)}agregarBrand(a){return console.log(a),this.http.post(`${this.baseUrl}/brand`,a)}editarBrand(a,o){return console.log(a),console.log(o),this.http.put(`${this.baseUrl}/brand/${o}`,a)}inactivarBrand(a){return this.http.put(`${this.baseUrl}/brand/inactivar/${a}`,[])}}return e.\u0275fac=function(a){return new(a||e)(t.LFG(U.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var w=r(6518),Z=r(2013),F=r(7009),y=r(4859),M=r(4850),p=r(9549),x=r(4144);function N(e,n){1&e&&(t.TgZ(0,"span",11),t._uU(1,"El nombre es requerido"),t.qZA())}let S=(()=>{class e{constructor(a,o,i,l,m,K,q,tt){this.fb=a,this.brandServices=o,this.authService=i,this.notifyService=l,this.dialog=m,this.snackBar=K,this.dialogRef=q,this.editdata=tt,this.dateTime=new Date,this.titulo="Agregar marca"}get usuario(){return this.authService.usuario}getCompany(){return sessionStorage.getItem("company")}ngOnInit(){this.login=this.authService.usuario.email.substring(0,this.authService.usuario.email.indexOf("@")),this.addbrandForm=this.fb.group({name:["",c.kI.required],description:[],isactive:1,createdon:this.dateTime,createdby:this.login,modifiedon:this.dateTime,modifiedby:"",bsc_company_companyid:this.getCompany()}),this.editdata&&(this.titulo="Editar marca",this.addbrandForm.controls.name.setValue(this.editdata.name),this.addbrandForm.controls.description.setValue(this.editdata.description))}guardar(){this.editdata?this.actualizarMarca():this.addbrandForm.valid&&this.brandServices.agregarBrand(this.addbrandForm.value).subscribe({next:a=>{this.notifyService.showSuccess("Marca agregada satisfactoriamente","SIFAC"),this.addbrandForm.reset(),this.dialogRef.close("save")},error:()=>{this.notifyService.showError("Error agregando la marca","SIFAC")}})}actualizarMarca(){this.brandServices.editarBrand(this.addbrandForm.value,this.editdata.brandid).subscribe({next:a=>{this.addbrandForm.reset(),this.dialogRef.close("update"),this.notifyService.showSuccess("Marca actualizada satisfactoriamente","SIFAC")},error:()=>{this.notifyService.showError("Error actualizando la marca","SIFAC")}})}campoEsValido(a){return this.addbrandForm.controls[a].errors&&this.addbrandForm.controls[a].touched}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(c.qu),t.Y36(C),t.Y36(w.e),t.Y36(Z.g),t.Y36(d.uw),t.Y36(F.ux),t.Y36(d.so),t.Y36(d.WI))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-agregar"]],decls:19,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["autocomplete","off",3,"formGroup"],["appearance","outline"],["formControlName","name","matInput","","placeholder","Nombre"],["class","form-text text-danger",4,"ngIf"],["appearance","fill",1,"example-full-width"],["formControlName","description","matInput","","placeholder","Descripci\xf3n..."],["mat-dialog-actions","",3,"align"],["mat-raised-button","","color","warn","mat-dialog-close",""],["mat-raised-button","","color","primary",3,"click"],[1,"form-text","text-danger"]],template:function(a,o){1&a&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t._UZ(2,"mat-divider"),t.TgZ(3,"div",1)(4,"form",2)(5,"mat-form-field",3)(6,"mat-label"),t._uU(7,"Nombre"),t.qZA(),t._UZ(8,"input",4),t.YNc(9,N,2,0,"span",5),t.qZA(),t.TgZ(10,"mat-form-field",6)(11,"mat-label"),t._uU(12,"Descripci\xf3n"),t.qZA(),t._UZ(13,"textarea",7),t.qZA()()(),t.TgZ(14,"div",8)(15,"button",9),t._uU(16," Cancelar"),t.qZA(),t.TgZ(17,"button",10),t.NdJ("click",function(){return o.guardar()}),t._uU(18," Guardar"),t.qZA()()),2&a&&(t.xp6(1),t.Oqu(o.titulo),t.xp6(3),t.Q6J("formGroup",o.addbrandForm),t.xp6(5),t.Q6J("ngIf",o.campoEsValido("name")),t.xp6(5),t.Q6J("align","end"))},dependencies:[g.O5,y.lW,M.d,p.KE,p.hX,x.Nt,d.ZT,d.uh,d.xY,d.H8,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),e})();var u=r(574),B=r(6838),Y=r(8572),E=r(3507),L=r(6761),I=r(3683),D=r(7392);function J(e,n){1&e&&(t.TgZ(0,"th",28),t._uU(1," Nombre "),t.qZA())}function O(e,n){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const a=n.$implicit;t.xp6(1),t.hij(" ",a.name," ")}}function z(e,n){1&e&&(t.TgZ(0,"th",28),t._uU(1," Descripci\xf3n "),t.qZA())}function R(e,n){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const a=n.$implicit;t.xp6(1),t.hij(" ",a.description," ")}}function Q(e,n){1&e&&t._UZ(0,"th",28)}function P(e,n){if(1&e){const a=t.EpF();t.TgZ(0,"td",29)(1,"button",30),t.NdJ("click",function(){const l=t.CHM(a).$implicit,m=t.oxw();return t.KtG(m.editBrand(l))}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.TgZ(4,"button",31),t.NdJ("click",function(){const l=t.CHM(a).$implicit,m=t.oxw();return t.KtG(m.mostrarConfirmacionEliminar(l.brandid))}),t.TgZ(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}}function $(e,n){1&e&&t._UZ(0,"tr",32)}function G(e,n){1&e&&t._UZ(0,"tr",33)}function H(e,n){if(1&e&&(t.TgZ(0,"tr",34)(1,"td",35),t._uU(2),t.qZA()()),2&e){t.oxw();const a=t.MAs(25);t.xp6(2),t.hij('No data matching the filter "',a.value,'"')}}const j=function(){return[5,10,25,100]},X=[{path:"",children:[{path:"lista",component:(()=>{class e{constructor(a,o,i){this.brandService=a,this.notifyService=o,this.dialog=i,this.displayedColumns=["name","description","action"],this.brand=[],this.name="Marcas.xlsx"}ngOnInit(){this.company=Number(this.getCompany()),this.getbrand()}getCompany(){return sessionStorage.getItem("company")}getbrand(){console.log(this.company),this.brandService.getbrands(this.company).subscribe({next:a=>{this.dataSource=new s.by(a),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort},error:a=>{console.log(a),this.notifyService.showError("Error obteniendo la lista","SIFAC")}})}applyFilter(a){this.dataSource.filter=a.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}openDialog(){this.dialog.open(S,{width:"30%"}).afterClosed().subscribe(a=>{"save"===a&&this.getbrand()})}editBrand(a){this.dialog.open(S,{width:"30%",data:a}).afterClosed().subscribe(o=>{"update"===o&&this.getbrand()})}eliminarBrand(a){this.brandService.inactivarBrand(a).subscribe({next:o=>{this.getbrand(),this.notifyService.showSuccess("La marca se inactivo correctamente.","SIFAC")},error:()=>{this.notifyService.showError("Error inactivando la marca","SIFAC")}})}mostrarConfirmacionEliminar(a){this.dialog.open(T.F,{data:"\xbfEsta seguro de inactivar la marca?"}).afterClosed().subscribe(o=>{o&&this.eliminarBrand(a)})}exportToExcel(){let a=document.getElementById("BrandTable");const o=u.P6.table_to_sheet(a),i=u.P6.book_new();u.P6.book_append_sheet(i,o,"Sheet1"),u.NC(i,this.name)}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(C),t.Y36(Z.g),t.Y36(d.uw))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-lista"]],viewQuery:function(a,o){if(1&a&&(t.Gf(h.YE,5),t.Gf(b.NW,5)),2&a){let i;t.iGM(i=t.CRH())&&(o.sort=i.first),t.iGM(i=t.CRH())&&(o.paginator=i.first)}},decls:44,vars:5,consts:[[1,"content-wrapper"],[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-sm-6"],["color","primary"],["mat-icon-button","","aria-label","Example icon-button with menu icon",1,"example-icon"],[1,"example-spacer"],["mat-raised-button","","mt-2","","color","warn",3,"click"],[1,"material-icons"],[1,"spacer"],[1,"container"],[2,"margin-top","10px"],["appearance","standard"],["autocomplete","off","matInput","","placeholder","Busqueda",3,"keyup"],["input",""],[1,"mat-elevation-z8"],["id","BrandTable","mat-table","","matSort","",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of users",3,"pageSizeOptions"],[1,"content"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(a,o){1&a&&(t._UZ(0,"app-main-header")(1,"app-main-sidebar"),t.TgZ(2,"div",0)(3,"div",1)(4,"div",2)(5,"div",3),t._UZ(6,"div",4),t.TgZ(7,"mat-toolbar",5)(8,"button",6)(9,"mat-icon"),t._uU(10," supervised_user_circle"),t.qZA()(),t.TgZ(11,"span"),t._uU(12,"Marcas"),t.qZA(),t._UZ(13,"span",7),t.TgZ(14,"button",8),t.NdJ("click",function(){return o.openDialog()}),t._uU(15,"Nuevo "),t.TgZ(16,"span",9),t._uU(17,"add"),t.qZA()(),t._UZ(18,"span",10),t.qZA(),t.TgZ(19,"div",11)(20,"div",12)(21,"mat-form-field",13)(22,"mat-label"),t._uU(23,"Buscar"),t.qZA(),t.TgZ(24,"input",14,15),t.NdJ("keyup",function(l){return o.applyFilter(l)}),t.qZA()(),t.TgZ(26,"div",16)(27,"table",17),t.ynx(28,18),t.YNc(29,J,2,0,"th",19),t.YNc(30,O,2,1,"td",20),t.BQk(),t.ynx(31,21),t.YNc(32,z,2,0,"th",19),t.YNc(33,R,2,1,"td",20),t.BQk(),t.ynx(34,22),t.YNc(35,Q,1,0,"th",19),t.YNc(36,P,7,0,"td",20),t.BQk(),t.YNc(37,$,1,0,"tr",23),t.YNc(38,G,1,0,"tr",24),t.YNc(39,H,3,1,"tr",25),t.qZA(),t._UZ(40,"mat-paginator",26),t.qZA()()()()()(),t._UZ(41,"section",27),t.qZA(),t._UZ(42,"app-control-sidebar")(43,"app-main-footer")),2&a&&(t.xp6(27),t.Q6J("dataSource",o.dataSource),t.xp6(10),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(4,j)))},dependencies:[B.$,Y.g,E.B,L.C,I.Ye,y.lW,D.Hw,p.KE,p.hX,x.Nt,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,b.NW,h.YE,h.nU],styles:['@charset "UTF-8";  .example-spacer{flex:1 1 auto}table[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{width:15%}.mat-header-cell[_ngcontent-%COMP%]{background:#7E2FB6;color:#fff}  .mat-sort-header-arrow[style] .mat-sort-header-stem{display:none}  .mat-sort-header-arrow[style] .mat-sort-header-indicator{opacity:10;color:#fff;font-weight:700}  .mat-sort-header-arrow[style] .mat-sort-header-indicator .mat-sort-header-pointer-left,   .mat-sort-header-arrow[style] .mat-sort-header-indicator .mat-sort-header-pointer-right,   .mat-sort-header-arrow[style] .mat-sort-header-indicator .mat-sort-header-pointer-middle{display:none}[aria-sort=ascending][_ngcontent-%COMP%]     .mat-sort-header-arrow .mat-sort-header-indicator:before{content:"\\25b4";top:0em;position:absolute;color:#fff;font-size:30px;line-height:10px}[aria-sort=descending][_ngcontent-%COMP%]     .mat-sort-header-arrow .mat-sort-header-indicator:before{content:"\\25be";top:-15px;position:absolute;color:#fff;font-size:30px}']}),e})()}]}];let V=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[v.Bz.forChild(X),v.Bz]}),e})();var W=r(1469),_=r(6443);let k=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[g.ez,V,W.m,_.q,c.UX]}),e})()}}]);